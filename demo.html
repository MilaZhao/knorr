<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº·å¯¶å»šè—æ™‚ä»£ Knorr Pro v8</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        /* --- 1. Design Tokens --- */
        :root {
            /* Colors */
            --primary: #00652B;
            --primary-light: #E6F0EA;
            --secondary: #FF5700;
            --secondary-light: #FFF0E5;
            --bg-body: #F7F9F8;
            --surface: #FFFFFF;
            
            /* Typography */
            --text-main: #2D3330;
            --text-body: #4A524F;
            --text-muted: #8C9692;
            
            /* Spacing */
            --sp-xs: 4px; --sp-sm: 8px; --sp-md: 16px; --sp-lg: 24px; --sp-xl: 32px;
            
            /* Elevation */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.04);
            --shadow-md: 0 8px 24px rgba(0, 101, 43, 0.08);
            
            /* Layout */
            --bottom-nav-height: 80px;
            --radius-md: 12px;
            --radius-lg: 20px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            background-color: var(--bg-body); color: var(--text-main); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding-bottom: var(--bottom-nav-height); line-height: 1.6;
        }

        /* --- 2. Header & Tabs --- */
        header { background-color: var(--surface); position: sticky; top: 0; z-index: 100; box-shadow: var(--shadow-sm); }
        .header-top { background-color: var(--primary); color: var(--surface); padding: var(--sp-sm) var(--sp-md); height: 56px; display: flex; align-items: center; gap: var(--sp-md); }
        .search-bar { flex: 1; background: rgba(255,255,255,0.15); border-radius: 30px; height: 36px; display: flex; align-items: center; padding: 0 var(--sp-md); color: white; font-size: 14px; gap: 8px; }
        .tab-bar { padding: var(--sp-md) 0; background: var(--surface); }
        .scrolling-wrapper { display: flex; overflow-x: auto; gap: 12px; padding: 0 var(--sp-md); scrollbar-width: none; }
        .scrolling-wrapper::-webkit-scrollbar { display: none; }
        .tab-chip { padding: 8px 16px; border-radius: 24px; font-size: 14px; font-weight: 500; color: var(--text-muted); background: #F0F2F1; white-space: nowrap; transition: 0.3s; cursor: pointer; border: 1px solid transparent; }
        .tab-chip.active { background: var(--primary-light); color: var(--primary); font-weight: 600; border-color: rgba(0, 101, 43, 0.2); }

        /* --- 3. Cards & Lists --- */
        .section-title { padding: var(--sp-lg) var(--sp-md) var(--sp-md); font-size: 18px; font-weight: 700; display: flex; justify-content: space-between; align-items: baseline; }
        .card-scroll-container { display: flex; overflow-x: auto; gap: var(--sp-md); padding: 0 var(--sp-md) var(--sp-lg); }
        .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: var(--sp-md); padding: 0 var(--sp-md) var(--sp-lg); }
        
        .card { background: var(--surface); border-radius: var(--radius-lg); overflow: hidden; box-shadow: var(--shadow-sm); transition: transform 0.2s; position: relative; }
        .card:active { transform: scale(0.98); }
        .card-img-wrapper { position: relative; padding-top: 65%; background: #eee; }
        .card-img { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
        .card-badge { position: absolute; top: 12px; left: 12px; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); color: white; font-size: 10px; font-weight: bold; padding: 4px 8px; border-radius: 4px; }
        .card-content { padding: 16px; }
        .card-title { font-size: 15px; font-weight: 700; margin-bottom: 8px; line-height: 1.4; }
        .card-meta { display: flex; gap: 8px; }
        .meta-tag { font-size: 11px; color: var(--text-body); background: #F0F2F1; padding: 4px 8px; border-radius: 6px; display: flex; align-items: center; gap: 4px; }

        .list-card { background: var(--surface); margin: 0 var(--sp-md) var(--sp-md); padding: 20px; border-radius: var(--radius-lg); box-shadow: var(--shadow-sm); display: flex; gap: var(--sp-md); align-items: start; }
        .list-card-img { width: 90px; height: 90px; border-radius: 12px; object-fit: cover; flex-shrink: 0; }

        /* --- 4. Detail View --- */
        #detail-view { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--surface); z-index: 2000; overflow-y: auto; display: none; }
        .detail-hero-section { position: relative; height: 300px; }
        .detail-hero-img { width: 100%; height: 100%; object-fit: cover; }
        .detail-back-btn { position: fixed; top: 16px; left: 16px; background: rgba(255,255,255,0.9); width: 40px; height: 40px; border-radius: 50%; display: flex; justify-content: center; align-items: center; box-shadow: 0 4px 12px rgba(0,0,0,0.15); cursor: pointer; z-index: 2010; }

        .detail-container { border-radius: 24px 24px 0 0; margin-top: -32px; background: var(--surface); position: relative; padding: 32px 24px 100px; min-height: 100vh; }
        
        h1.detail-title { font-size: 26px; font-weight: 800; color: var(--text-main); margin-bottom: 8px; line-height: 1.3; }
        p.detail-subtitle { font-size: 15px; color: var(--text-body); margin-bottom: 24px; line-height: 1.6; }
        h3.section-header { font-size: 18px; font-weight: 700; color: var(--text-main); margin: 40px 0 16px; display: flex; align-items: center; gap: 8px; padding-left: 12px; border-left: 4px solid var(--secondary); }
        .body-text { font-size: 16px; line-height: 1.8; color: var(--text-body); margin-bottom: 16px; }

        /* Components for Details */
        .info-grid { display: flex; gap: 12px; margin-bottom: 32px; }
        .info-box { flex: 1; background: #FAFAFA; border: 1px solid #EEE; border-radius: 12px; padding: 12px; text-align: center; }
        .info-label { font-size: 12px; color: var(--text-muted); margin-bottom: 4px; display: flex; justify-content: center; gap: 4px; }
        .info-value { font-size: 15px; font-weight: 700; color: var(--primary); }

        .ing-group { margin-bottom: 16px; }
        .ing-title { font-size: 14px; font-weight: 700; color: var(--text-main); margin-bottom: 8px; background: #eee; display: inline-block; padding: 4px 8px; border-radius: 4px; }
        .ing-item { display: flex; align-items: center; gap: 12px; padding: 8px 0; border-bottom: 1px solid #f5f5f5; }
        .checkbox-circle { width: 20px; height: 20px; border: 2px solid #ddd; border-radius: 50%; }

        .step-row { display: flex; gap: 16px; margin-bottom: 32px; }
        .step-idx { font-size: 14px; font-weight: 800; color: white; background: var(--secondary); width: 24px; height: 24px; border-radius: 50%; text-align: center; line-height: 24px; flex-shrink: 0; margin-top: 2px; }
        .step-content { flex: 1; }
        .step-tip { background: #FFF9E6; border: 1px solid #FFE0B2; padding: 12px; border-radius: 8px; margin-top: 12px; font-size: 14px; color: #8F6B00; display: flex; gap: 8px; }

        /* SOP Specific Styles */
        .sop-card { background: var(--primary-light); padding: 24px; border-radius: 16px; margin-bottom: 24px; display:flex; gap:16px; align-items:flex-start; }
        .sop-icon { background: var(--primary); color: white; width: 48px; height: 48px; border-radius: 12px; display: flex; justify-content: center; align-items: center; flex-shrink: 0; }

        .tldr-box { background: var(--primary-light); border: 1px solid rgba(0,101,43,0.1); border-radius: 12px; overflow: hidden; margin-bottom: 24px; }
        .tldr-header { padding: 12px 16px; font-weight: 700; color: var(--primary); display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .tldr-body { padding: 0 16px 16px; display: none; }
        .tldr-body.show { display: block; }
        .tldr-item { display: flex; gap: 8px; margin-bottom: 8px; font-size: 15px; color: var(--text-body); }

        .comparison-table { width: 100%; border-collapse: separate; border-spacing: 0; border: 1px solid #eee; border-radius: 12px; overflow: hidden; margin-bottom: 20px; font-size: 14px; }
        .comparison-table th { background: #f9f9f9; padding: 12px; font-weight: 600; text-align: center; border-bottom: 1px solid #eee; }
        .comparison-table td { padding: 12px; text-align: center; border-bottom: 1px solid #eee; color: var(--text-body); }

        .h-scroll { display: flex; gap: 12px; overflow-x: auto; padding-bottom: 8px; scrollbar-width: none; }
        .mu-card { min-width: 100px; background: #fff; border: 1px solid #eee; border-radius: 8px; padding: 8px; text-align: center; }

        .action-btn { width: 100%; background: var(--secondary); color: white; padding: 16px; border-radius: 12px; font-weight: 700; font-size: 16px; border: none; margin-top: 40px; box-shadow: 0 8px 20px rgba(255,87,0,0.25); display: flex; justify-content: center; align-items: center; gap: 8px; cursor: pointer; }

        /* --- 5. Bottom Nav --- */
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: var(--bottom-nav-height); background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); border-top: 1px solid rgba(0,0,0,0.05); display: flex; justify-content: space-around; padding-top: 12px; z-index: 1000; }
        .nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: #999; cursor: pointer; flex: 1; }
        .nav-item.active { color: var(--primary); }
        .nav-text { font-size: 10px; font-weight: 500; }
        .nav-item.scan-btn { position: relative; top: -28px; }
        .scan-circle { width: 56px; height: 56px; background: var(--primary); border-radius: 50%; box-shadow: var(--shadow-md); display: flex; justify-content: center; align-items: center; color: white; border: 4px solid var(--bg-body); }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    </style>
</head>
<body>

    <div id="app-root"></div>

    <div id="detail-view">
        <div class="detail-back-btn" onclick="closeDetail()">
            <span class="material-symbols-outlined">arrow_back</span>
        </div>
        <div class="detail-hero-section">
            <img id="detail-img" class="detail-hero-img" src="" alt="">
        </div>
        <div class="detail-container">
            <div id="detail-content"></div>
        </div>
    </div>

    <nav class="bottom-nav">
        <div class="nav-item active" onclick="router('home')">
            <span class="material-symbols-outlined">home</span><span class="nav-text">é¦–é </span>
        </div>
        <div class="nav-item" onclick="router('info')">
            <span class="material-symbols-outlined">article</span><span class="nav-text">é¤é£²æƒ…å ±</span>
        </div>
        <div class="nav-item scan-btn" onclick="router('scan')">
            <div class="scan-circle"><span class="material-symbols-outlined" style="font-size: 28px;">qr_code_scanner</span></div>
            <span class="nav-text" style="margin-top: 4px; color: var(--primary); font-weight: 700;">é›†é»</span>
        </div>
        <div class="nav-item" onclick="router('recipes')">
            <span class="material-symbols-outlined">menu_book</span><span class="nav-text">å°ˆæ¥­é£Ÿè­œ</span>
        </div>
        <div class="nav-item" onclick="router('shop')">
            <span class="material-symbols-outlined">shopping_cart</span><span class="nav-text">è³¼è²·</span>
        </div>
    </nav>

    <script>
        // --- Data ---
        const db = {
            sop: {
                id: 999,
                title: "3æ­¥é©Ÿå‡ºé¤ SOP",
                subtitle: "è§£æ±ºåˆé¤é«˜å³°æœŸçš„é€Ÿåº¦ç„¦æ…®ï¼Œæ¨™æº–åŒ–æµç¨‹æå‡ç¿»æ¡Œç‡",
                img: "https://placehold.co/800x600/6A1B9A/FFF?text=Kitchen+SOP",
                desc: "é‡å°ç¹å¿™å»šæˆ¿è¨­è¨ˆçš„æ¨™æº–ä½œæ¥­æµç¨‹ (SOP)ã€‚é€éæ ¸å¿ƒé†¬æ–™èˆ‡é è£½å‚™æ–™ï¼Œå°‡å‡ºé¤æ™‚é–“å£“ç¸®è‡³ 3 åˆ†é˜ä»¥å…§ï¼Œç„¡éœ€ä¾è³´è³‡æ·±å»šå¸«ä¹Ÿèƒ½ç¶­æŒç©©å®šå“è³ªã€‚",
                steps: [
                    { title: "æ­¥é©Ÿ 1ï¼šå…èª¿å‘³å‚™æ–™ (Sauce Ready)", text: "ä½¿ç”¨åº·å¯¶å°ˆæ¥­é†¬æ–™ï¼ˆå¦‚æ‰“æ‹‹é†¬ã€éº»è¾£é†¬ï¼‰å–ä»£å‚³çµ± 8-10 ç¨®ç“¶ç½èª¿å‘³ã€‚é†¬æ–™å·²åŒ…å«åŸºç¤é¹¹åº¦èˆ‡é¦™æ°£ï¼Œç„¡éœ€ç¾å ´ç§¤é‡èª¿é…ã€‚", tip: "å»ºè­°å°‡é†¬æ–™åˆ†è£è‡³æ“ å£“ç“¶ï¼Œä¸¦æ¨™ç¤ºåˆ»åº¦ï¼Œå·¥è®€ç”Ÿä¹Ÿèƒ½ç²¾æº–æ“ä½œã€‚" },
                    { title: "æ­¥é©Ÿ 2ï¼šé£Ÿæçµ±ä¸€è¦æ ¼ (Pre-Prep)", text: "è‚‰é¡èˆ‡è”¬èœä¾ç…§æ¨™æº–è¦æ ¼é å…ˆåˆ‡è£½ã€éæ²¹æˆ–æ±†ç‡™ã€‚è‚‰ç‰‡å»ºè­°é å…ˆé†ƒè£½ï¼ˆä½¿ç”¨é›ç²‰èˆ‡å¤ªç™½ç²‰ï¼‰ä¸¦åˆ†è¢‹å†·è—ï¼Œæ¯è¢‹å³ç‚ºä¸€ä»½ã€‚", tip: "è”¬èœé¡å¯ä¾ç…§ç†Ÿæˆæ™‚é–“åˆ†é¡ï¼Œé›£ç†Ÿçš„å…ˆç‡™è‡³ 7 åˆ†ç†Ÿã€‚" },
                    { title: "æ­¥é©Ÿ 3ï¼šå¤§ç«å¿«ç‚’å‡ºé¤ (Flash Fry)", text: "ç†±é‹å¾Œä¾åºæ”¾å…¥é£Ÿæèˆ‡é†¬æ–™ã€‚å› é†¬æ–™ç„¡éœ€ç­‰å¾…æº¶åŒ–ï¼Œåªéœ€å¤§ç«ç¿»ç‚’ 45-60 ç§’è®“é‘Šæ°£åŒ…è¦†å³å¯èµ·é‹ã€‚", tip: "å‡ºé¤å‰åªéœ€å°ˆæ³¨æ“ºç›¤ï¼Œç„¡éœ€è©¦å‘³ï¼Œç¢ºä¿æ¯ä¸€ç›¤å‘³é“ä¸€è‡´ã€‚" }
                ],
                relatedRecipes: [
                     { name: "æ‰“æ‹‹è±¬", time: "10åˆ†" },
                     { name: "å›é‹è‚‰", time: "8åˆ†" },
                     { name: "é»‘æ¤’ç‰›", time: "5åˆ†" }
                ]
            },
            recipes: [
                { 
                    id: 1, title: "éº»è¾£æ°´ç…®é­š", subtitle: "æ–°å·èœé¢¨æ ¼ï¼Œé¦™éº»è¾£çˆ½ï¼Œå±¤æ¬¡è±å¯Œ", 
                    category: ["all", "chef", "spicy"], 
                    stats: { time: "15åˆ†", cost: "45å…ƒ", diff: "ä¸­" }, 
                    type: "åå»š", img: "https://placehold.co/800x600/FF5700/FFF?text=Spicy+Fish",
                    author: "æ±ŸæŒ¯èª ä¸»å»š",
                    desc: "é€éä½æº«æ…¢ç…®é–ä½è‚‰æ±ï¼Œæ­é…åº·å¯¶éº»è¾£é†¬èˆ‡ç‰¹è£½èŠ±æ¤’æ²¹ï¼Œå‘ˆç¾å¤šå±¤æ¬¡é¦™æ°£ã€‚é©åˆè¿½æ±‚ç²¾ç·»å£æ„Ÿçš„é¤å»³ã€‚",
                    ingredients: { main: ["é±¸é­šç‰‡ 400g", "è±†èŠ½èœ 200g", "é’æ±Ÿèœ 150g"], seasoning: ["åº·å¯¶éº»è¾£é†¬ 3å¤§åŒ™", "åº·å¯¶é›ç²‰ 1å°åŒ™", "èŠ±æ¤’ç²’ 1å¤§åŒ™"] },
                    steps: [
                        { title: "é­šç‰‡é†ƒè£½", text: "é±¸é­šç‰‡åˆ‡è–„ç‰‡ï¼Œç”¨é¹½ã€å¤ªç™½ç²‰é†ƒè£½10åˆ†é˜ã€‚", tip: "å¤ªç™½ç²‰è®“é­šè‚‰æ›´æ»‘å«©ã€‚" },
                        { title: "ç‚’é†¬æ–™", text: "èµ·æ²¹é‹ï¼Œæ”¾å…¥åº·å¯¶éº»è¾£é†¬ç‚’é¦™ç´„1åˆ†é˜ã€‚", tip: "ä¸­å°ç«é¿å…ç‡’ç„¦ã€‚" },
                        { title: "ç…®æ¹¯åº•", text: "åŠ å…¥é«˜æ¹¯ã€åº·å¯¶é›ç²‰ã€è–‘ç‰‡ï¼Œç…®æ»¾å¾Œè½‰ä¸­ç«ã€‚", tip: "åº·å¯¶é›ç²‰å¯æå‡æ¹¯åº•é®®å‘³ã€‚" }
                    ],
                    qa: [{ q: "å¦‚ä½•è®“é­šè‚‰æ›´æ»‘å«©?", a: "é™¤äº†å¤ªç™½ç²‰ï¼ŒåŠ ä¸€é»è›‹ç™½ä¹Ÿæœ‰æ•ˆæœã€‚" }],
                    related: "åº·å¯¶éº»è¾£é†¬"
                },
                { 
                    id: 2, title: "æ³°å¼æ‰“æ‹‹è±¬", subtitle: "10 åˆ†é˜å¿«é€Ÿå‡ºé¤ï¼Œå®¢äººè¶…æ„›é»", 
                    category: ["all", "lazy", "low_cost"], 
                    stats: { time: "10åˆ†", cost: "38å…ƒ", diff: "æ˜“" }, 
                    type: "æ‡¶äººåŒ…", img: "https://placehold.co/800x600/00652B/FFF?text=Thai+Pork",
                    author: "åº·å¯¶ç ”ç™¼åœ˜éšŠ",
                    desc: "ä½¿ç”¨åº·å¯¶æ³°å¼æ‰“æ‹‹é†¬ï¼Œä¸€é†¬æå®šè¤‡é›œèª¿å‘³ï¼Œè§£æ±ºå¾Œå»šå‚™æ–™ç…©æƒ±ã€‚",
                    ingredients: { main: ["è±¬çµè‚‰ 150g", "ä¹å±¤å¡” 1æŠŠ"], seasoning: ["åº·å¯¶æ³°å¼æ‰“æ‹‹é†¬ 2å¤§åŒ™", "é­šéœ² 1å°åŒ™"] },
                    steps: [
                        { title: "ç‚’çµè‚‰", text: "ç†±é‹çˆ†é¦™è’œæœ«ï¼ŒåŠ å…¥è±¬çµè‚‰ç‚’è‡³è®Šè‰²ã€‚", tip: "ä¸­å¤§ç«å¿«ç‚’ã€‚" },
                        { title: "åŠ é†¬æ–™", text: "åŠ å…¥åº·å¯¶æ‰“æ‹‹é†¬æ‹Œç‚’å‡å‹»ã€‚", tip: "ç„¡éœ€å†åŠ å…¶ä»–èª¿å‘³æ–™ï¼" }
                    ],
                    related: "åº·å¯¶æ³°å¼æ‰“æ‹‹é†¬"
                }
            ],
            info: [
                { 
                    id: 101, title: "éŸ“å¼ç™¼é…µé†¬æ‡‰ç”¨", category: "trend", 
                    subtitle: "ç‚ºç¶“å…¸èœè‰²æ³¨å…¥ç¨ç‰¹é¢¨å‘³å±¤æ¬¡", img: "https://placehold.co/800x600/eee/333?text=Korean+Sauce", 
                    meta: { time: "3åˆ†é˜", views: "1.2k", author: "æ±ŸæŒ¯èª " },
                    tldr: ["éŸ“å¼ç™¼é…µé†¬å¯å–ä»£å‚³çµ±é†ƒæ–™", "æˆæœ¬é™ä½30%"],
                    sections: [
                        { title: "ç‚ºä»€éº¼ç™¼é…µé†¬æ­£åœ¨æµè¡Œ?", content: "ä½¿ç”¨ç™¼é…µèª¿å‘³å“çš„é¤å»³æ¯”å‚³çµ±é¤å»³å¤šå‡º 35% çš„å›å®¢ç‡ã€‚" },
                         { title: "æˆæœ¬èˆ‡æ•ˆç›Šåˆ†æ", table: { headers: ["é …ç›®", "è‡ªè£½", "åº·å¯¶"], rows: [["è£½ä½œ", "90å¤©", "å³ç”¨"], ["æˆæœ¬", "15å…ƒ", "8å…ƒ"]] } }
                    ],
                    related: "åº·å¯¶éŸ“å¼è¾£é†¬"
                }
            ]
        };

        // --- Logic ---
        let currentPage = 'home', currentTab = 'all';

        function router(page) {
            currentPage = page; currentTab = 'all';
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            const navMap = {'home':0, 'info':1, 'scan':2, 'recipes':3, 'shop':4};
            if(document.querySelectorAll('.nav-item')[navMap[page]]) document.querySelectorAll('.nav-item')[navMap[page]].classList.add('active');
            render(); window.scrollTo(0,0);
        }

        function switchTab(label, index) {
            document.querySelectorAll('.tab-chip').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-chip')[index].classList.add('active');
            const map = { 'home': ['all','chef','lazy','low_cost'], 'recipes': ['all','chef','lazy','low_cost'], 'info': ['all','manage','trend'] };
            currentTab = map[currentPage][index];
            const contentEl = document.getElementById('tab-content');
            if(currentPage === 'home') contentEl.innerHTML = renderHomeContent(currentTab);
            if(currentPage === 'recipes') contentEl.innerHTML = renderRecipeList(currentTab);
            if(currentPage === 'info') contentEl.innerHTML = renderInfoList(currentTab);
        }

        function render() {
            const root = document.getElementById('app-root');
            let content = '';
            if(currentPage === 'home') content = renderHeader(['ç‚ºä½ æ¨è–¦','åå»šæŠ€æ³•','æ‡¶äººåŒ…','ä½æˆæœ¬']) + `<div id="tab-content">${renderHomeContent('all')}</div>`;
            else if(currentPage === 'recipes') content = renderHeader(['å…¨éƒ¨','åå»šå°ˆå€','æ‡¶äººåŒ…','ä½æˆæœ¬']) + `<div id="tab-content" class="container">${renderRecipeList('all')}</div>`;
            else if(currentPage === 'info') content = renderHeader(['æœ€æ–°æƒ…å ±','ç¶“ç‡Ÿç®¡ç†','é¤é£²è¶¨å‹¢']) + `<div id="tab-content">${renderInfoList('all')}</div>`;
            else if(currentPage === 'scan') content = renderScan();
            else if(currentPage === 'shop') content = `<div style="display:flex;justify-content:center;align-items:center;height:80vh;color:#999;">å•†åŸè¼‰å…¥ä¸­...</div>`;
            root.innerHTML = content;
        }

        function renderHeader(tabs) {
            return `<header>
                <div class="header-top"><div class="search-bar"><span class="material-symbols-outlined">search</span><span>æœå°‹...</span></div><span class="material-symbols-outlined">notifications</span></div>
                <div class="tab-bar"><div class="scrolling-wrapper">${tabs.map((t,i)=>`<div class="tab-chip ${i===0?'active':''}" onclick="switchTab('${t}',${i})">${t}</div>`).join('')}</div></div>
            </header>`;
        }

        function renderHomeContent(filter) {
            let list = db.recipes;
            if(filter!=='all') list = db.recipes.filter(r => r.category.includes(filter));
            return `<div class="fade-in">
                ${filter==='all' ? `<div style="padding:24px 20px 0;"><h2 style="font-size:22px;font-weight:800;color:var(--primary);margin-bottom:4px;">æ—©å®‰ï¼Œå¼µä¸»å»š</h2><p style="color:#666;font-size:14px;">ä»Šå¤©å»šæˆ¿é‚„é †åˆ©å—ï¼Ÿ</p></div>`:''}
                <div class="section-title"><span>${filter==='all'?'æœ¬æœˆç²¾é¸':'æ¨è–¦é£Ÿè­œ'}</span></div>
                <div class="card-scroll-container">${list.map(r => `<div class="card recipe-card" style="min-width:220px;" onclick="openDetail('recipe',${r.id})"><div class="card-img-wrapper"><span class="card-badge">${r.type}</span><img class="card-img" src="${r.img}"></div><div class="card-content"><div class="card-title">${r.title}</div><div class="card-meta"><div class="meta-tag">${r.stats.time}</div><div class="meta-tag">${r.stats.cost}</div></div></div></div>`).join('')}</div>
                <div style="padding:24px 20px;">
                    <div onclick="openDetail('sop', 999)" style="background:linear-gradient(135deg,#00652B,#004d20);border-radius:16px;padding:24px;color:white;display:flex;align-items:center;gap:16px;box-shadow:var(--shadow-md);cursor:pointer;">
                        <span class="material-symbols-outlined" style="font-size:32px;">bolt</span>
                        <div><div style="font-weight:700;font-size:16px;">3æ­¥é©Ÿå‡ºé¤ SOP</div><div style="font-size:12px;opacity:0.8;">åˆé¤é«˜å³°æ•‘æ˜Ÿï¼Œé»æ“ŠæŸ¥çœ‹</div></div>
                    </div>
                </div>
            </div>`;
        }

        function renderRecipeList(filter) {
            let list = db.recipes;
            if(filter!=='all') list = list.filter(r => r.category.includes(filter));
            return `<div class="fade-in grid-container" style="padding-top:24px;">${list.map(r => `<div class="card" onclick="openDetail('recipe',${r.id})"><div class="card-img-wrapper"><span class="card-badge">${r.type}</span><img class="card-img" src="${r.img}"></div><div class="card-content"><div class="card-title">${r.title}</div><div class="card-meta"><div class="meta-tag">${r.stats.time}</div></div></div></div>`).join('')}</div>`;
        }

        function renderInfoList(filter) {
            let list = db.info;
            if(filter!=='all') list = list.filter(i => i.category === filter);
            return `<div class="fade-in" style="padding-top:24px;">${list.map(i => `<div class="list-card" onclick="openDetail('info',${i.id})"><div style="flex:1;"><span style="font-size:12px;color:var(--primary);font-weight:600;">#${i.category.toUpperCase()}</span><div class="card-title" style="font-size:16px; margin:4px 0;">${i.title}</div><div style="font-size:13px;color:#666;">${i.meta.views} é–±è®€</div></div><img class="list-card-img" src="${i.img}"></div>`).join('')}</div>`;
        }

        function renderScan() {
            return `<div style="height:100vh;background:#111;display:flex;flex-direction:column;align-items:center;justify-content:center;color:white;"><div style="width:240px;height:240px;border:2px solid var(--secondary);border-radius:24px;position:relative;display:flex;justify-content:center;align-items:center;"><span class="material-symbols-outlined" style="font-size:48px;opacity:0.5;">qr_code_2</span></div><div style="margin-top:24px;opacity:0.8;">å°‡ QR Code æ”¾å…¥æ¡†å…§</div><div style="position:absolute;bottom:100px;width:90%;background:white;border-radius:16px;padding:20px;color:#333;"><div style="display:flex;justify-content:space-between;align-items:flex-end;"><span style="font-weight:700;font-size:18px;">ç¾æœ‰é»æ•¸ 850</span><span style="color:var(--secondary);font-size:12px;font-weight:600;">å·® 150 é»å¯å…Œæ›</span></div><div style="height:6px;background:#eee;border-radius:3px;margin-top:12px;overflow:hidden;"><div style="width:85%;height:100%;background:var(--secondary);"></div></div></div></div>`;
        }

        // --- Detail View ---
        function openDetail(type, id) {
            const view = document.getElementById('detail-view');
            const img = document.getElementById('detail-img');
            const content = document.getElementById('detail-content');
            let html = '';

            if (type === 'sop') {
                const s = db.sop;
                img.src = s.img;
                html = `
                    <h1 class="detail-title">${s.title}</h1>
                    <p class="detail-subtitle">${s.subtitle}</p>
                    <div style="background:#F3E5F5; color:#4A148C; padding:16px; border-radius:12px; margin-bottom:24px; font-size:14px; line-height:1.6;">${s.desc}</div>
                    
                    <h3 class="section-header">æ¨™æº–æµç¨‹ (SOP)</h3>
                    <div>${s.steps.map((st, i) => `
                        <div class="sop-card">
                            <div class="sop-icon"><span class="material-symbols-outlined" style="font-size:24px;">${i===0?'liquor':i===1?'grid_view':'skillet'}</span></div>
                            <div>
                                <div style="font-weight:700; font-size:16px; color:var(--text-main); margin-bottom:8px;">${st.title}</div>
                                <div style="font-size:14px; color:var(--text-body); margin-bottom:8px;">${st.text}</div>
                                <div style="font-size:13px; color:#666; background:rgba(255,255,255,0.6); padding:8px; border-radius:8px;">ğŸ’¡ ${st.tip}</div>
                            </div>
                        </div>`).join('')}
                    </div>

                    <h3 class="section-header">æ¨è–¦æ‡‰ç”¨èœè‰²</h3>
                    <div class="h-scroll" style="margin-bottom:40px;">
                        ${s.relatedRecipes.map(r => `
                            <div class="mu-card" style="min-width:120px;">
                                <span class="material-symbols-outlined" style="color:var(--primary);">restaurant</span>
                                <div style="font-size:13px; font-weight:700; margin-top:4px;">${r.name}</div>
                                <div style="font-size:12px; color:#999;">${r.time}</div>
                            </div>`).join('')}
                    </div>

                    <button class="action-btn">ç€è¦½æ‰€æœ‰æ‡¶äººåŒ…é£Ÿè­œ</button>
                `;
            } else if (type === 'recipe') {
                const r = db.recipes.find(x => x.id === id);
                img.src = r.img;
                html = `
                    <h1 class="detail-title">${r.title}</h1>
                    <p class="detail-subtitle">${r.subtitle}</p>
                    <div class="info-grid">
                        <div class="info-box"><div class="info-label"><span class="material-symbols-outlined" style="font-size:14px">schedule</span>æ™‚é–“</div><div class="info-value">${r.stats.time}</div></div>
                        <div class="info-box"><div class="info-label"><span class="material-symbols-outlined" style="font-size:14px">attach_money</span>æˆæœ¬</div><div class="info-value">${r.stats.cost}</div></div>
                        <div class="info-box"><div class="info-label"><span class="material-symbols-outlined" style="font-size:14px">signal_cellular_alt</span>é›£åº¦</div><div class="info-value">${r.stats.diff}</div></div>
                    </div>
                    <p class="body-text">${r.desc}</p>
                    <h3 class="section-header">æ‰€éœ€ææ–™</h3>
                    <div style="margin-bottom:32px;">
                        <div class="ing-group"><div class="ing-title">ä¸»é£Ÿæ</div>${r.ingredients.main.map(x=>`<div class="ing-item"><div class="checkbox-circle"></div><span>${x}</span></div>`).join('')}</div>
                        <div class="ing-group"><div class="ing-title">èª¿å‘³æ–™</div>${r.ingredients.seasoning.map(x=>`<div class="ing-item"><div class="checkbox-circle"></div><span>${x}</span></div>`).join('')}</div>
                    </div>
                    <h3 class="section-header">çƒ¹èª¿æ­¥é©Ÿ</h3>
                    <div>${r.steps.map((s,i) => `<div class="step-row"><div class="step-idx">${i+1}</div><div class="step-content"><div style="font-weight:700;margin-bottom:4px;">${s.title}</div><div style="color:var(--text-body);font-size:15px;">${s.text}</div>${s.tip ? `<div class="step-tip"><span class="material-symbols-outlined" style="font-size:18px;">lightbulb</span><span>${s.tip}</span></div>` : ''}</div></div>`).join('')}</div>
                    ${r.qa ? `<h3 class="section-header">ä¸»å»š Q&A</h3><div style="background:#f5f5f5;border-radius:12px;padding:16px;">${r.qa.map(q=>`<div style="margin-bottom:12px;"><div style="font-weight:700;font-size:14px;margin-bottom:4px;">Q: ${q.q}</div><div style="font-size:14px;color:#555;">A: ${q.a}</div></div>`).join('')}</div>` : ''}
                    <button class="action-btn"><span class="material-symbols-outlined">shopping_bag</span> åŠ å…¥æ¡è³¼æ¸…å–® (${r.related})</button>
                `;
            } else if (type === 'info') {
                const i = db.info.find(x => x.id === id);
                img.src = i.img;
                html = `
                    <h1 class="detail-title">${i.title}</h1>
                    <p class="detail-subtitle">${i.subtitle}</p>
                    <div style="display:flex;gap:16px;color:#888;font-size:13px;margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #eee;"><span><span class="material-symbols-outlined" style="vertical-align:middle;font-size:16px;">schedule</span> ${i.meta.time}</span><span><span class="material-symbols-outlined" style="vertical-align:middle;font-size:16px;">visibility</span> ${i.meta.views}</span></div>
                    <div class="tldr-box">
                        <div class="tldr-header" onclick="this.nextElementSibling.classList.toggle('show')"><span>âš¡ é‡é»æ‘˜è¦ (TL;DR)</span><span class="material-symbols-outlined">expand_more</span></div>
                        <div class="tldr-body show">${i.tldr.map(t=>`<div class="tldr-item"><span class="material-symbols-outlined" style="font-size:18px;color:var(--secondary);">check</span><span>${t}</span></div>`).join('')}</div>
                    </div>
                    ${i.sections.map(sec => `<div style="margin-bottom:32px;"><h3 class="section-header">${sec.title}</h3>${sec.content ? `<p class="body-text">${sec.content}</p>` : ''}${sec.table ? `<table class="comparison-table"><thead><tr>${sec.table.headers.map(h=>`<th>${h}</th>`).join('')}</tr></thead><tbody>${sec.table.rows.map(r=>`<tr>${r.map(c=>`<td>${c}</td>`).join('')}</tr>`).join('')}</tbody></table>` : ''}</div>`).join('')}
                    <button class="action-btn"><span class="material-symbols-outlined">shopping_cart</span> æŸ¥çœ‹ç›¸é—œç”¢å“ (${i.related})</button>
                `;
            }
            content.innerHTML = html;
            view.style.display = 'block';
            document.body.style.overflow = 'hidden';
        }

        function closeDetail() {
            document.getElementById('detail-view').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        router('home');
    </script>
</body>
</html>